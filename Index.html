<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#2E7D32">
    <title>–°–∏—Å—Ç–µ–º–∞ 5 –ö—Ä–µ–ø–æ—Å—Ç–µ–π</title>
    <style>
        :root {
            --primary: #2E7D32; /* –ó–µ–ª–µ–Ω—ã–π */
            --bg: #f4f4f9;
            --text: #333;
            --border: #ccc;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0; padding: 0;
            background-color: var(--bg);
            color: var(--text);
            padding-bottom: 80px;
        }

        /* --- –≠–ö–†–ê–ù –í–•–û–î–ê --- */
        #loginOverlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #ffffff; z-index: 2000;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
        }
        .login-box {
            width: 300px; text-align: center; padding: 20px;
            background: #fff; border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }
        .login-btn {
            display: block; width: 100%; padding: 15px; margin-bottom: 10px;
            background: white; border: 2px solid var(--primary); color: var(--primary);
            font-size: 18px; font-weight: bold; border-radius: 8px; cursor: pointer;
            transition: 0.2s;
        }
        .login-btn:hover { background: var(--primary); color: white; }

        /* --- –û–°–ù–û–í–ù–û–ô –ò–ù–¢–ï–†–§–ï–ô–° --- */
        .container { max-width: 1200px; margin: 0 auto; padding: 10px; }

        header {
            background: white; padding: 15px; margin-bottom: 20px; border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            display: flex; justify-content: space-between; align-items: center;
        }
        h1 { margin: 0; font-size: 20px; color: var(--primary); }
        .user-panel { font-size: 14px; text-align: right; }
        .btn-link { background:none; border:none; color:blue; text-decoration:underline; cursor:pointer; margin-left:10px; }

        /* –ò–ù–°–¢–†–£–ö–¶–ò–Ø (–¢–≤–æ–π —Ç–µ–∫—Å—Ç) */
        .instruction-box {
            background: #e8f5e9; border-left: 5px solid var(--primary);
            padding: 15px; border-radius: 4px; margin-bottom: 20px; font-size: 13px; line-height: 1.4;
        }
        .instruction-box h3 { margin-top: 0; color: var(--primary); margin-bottom: 10px; }
        .f-tag { font-weight: bold; display: inline-block; padding: 2px 5px; border-radius: 4px; color: white; margin-right: 5px; }
        
        .f5 { background: #7b1fa2; } /* –§–∏–æ–ª–µ—Ç–æ–≤—ã–π */
        .f1 { background: #2e7d32; } /* –ó–µ–ª–µ–Ω—ã–π */
        .f2 { background: #0277bd; } /* –°–∏–Ω–∏–π */
        .f3 { background: #ef6c00; } /* –û—Ä–∞–Ω–∂–µ–≤—ã–π */

        /* –¢–ê–ë–õ–ò–¶–ê */
        .table-wrap { overflow-x: auto; background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        table {
            width: 100%; border-collapse: collapse; font-size: 13px; min-width: 900px;
        }
        th {
            background: var(--primary); color: white; padding: 12px 8px; text-align: left; vertical-align: top;
        }
        td {
            border-bottom: 1px solid var(--border); padding: 10px 8px; vertical-align: top;
        }
        tr:nth-child(even) { background-color: #f9f9f9; }
        
        /* –ö–æ–ª–æ–Ω–∫–∏ */
        .col-f3 { border-right: 1px solid #eee; color: #ef6c00; }
        .col-f2 { border-right: 1px solid #eee; color: #0277bd; font-weight: 500; }
        .col-f1 { border-right: 1px solid #eee; color: #2e7d32; font-weight: 700; background: #f1f8e9; }
        .col-f5 { border-right: 1px solid #eee; color: #7b1fa2; font-style: italic; }

        /* –ß–µ–∫–±–æ–∫—Å */
        input[type="checkbox"] { transform: scale(1.5); accent-color: var(--primary); cursor: pointer; }
        .done-row { text-decoration: line-through; color: #aaa !important; background: #eee !important; }
        .done-row td { color: #aaa !important; }

        /* –ú–û–î–ê–õ–ö–ê */
        .modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); display: none; justify-content: center; align-items: center; z-index: 3000;
        }
        .modal-content {
            background: white; padding: 25px; border-radius: 10px; width: 90%; max-width: 400px;
        }
        label { display: block; margin-top: 15px; font-weight: bold; }
        input, select { width: 100%; padding: 10px; margin-top: 5px; box-sizing: border-box; border: 1px solid #ccc; }
        .btn-action {
            width: 100%; padding: 12px; margin-top: 20px; background: var(--primary);
            color: white; border: none; font-size: 16px; cursor: pointer; border-radius: 5px;
        }

    </style>
</head>
<body>

<!-- 1. –í–•–û–î -->
<div id="loginOverlay">
    <div class="login-box">
        <h2 style="color:var(--primary); margin:0 0 20px 0;">5 –ö—Ä–µ–ø–æ—Å—Ç–µ–π</h2>
        <button class="login-btn" onclick="attemptLogin('Ayub')">Ayub üîí</button>
        <button class="login-btn" onclick="attemptLogin('Abdulla')">Abdulla</button>
        <button class="login-btn" onclick="attemptLogin('Daud')">Daud</button>
    </div>
</div>

<!-- 2. –ò–ù–¢–ï–†–§–ï–ô–° -->
<div class="container" id="appContainer" style="display:none;">
    <header>
        <div>
            <h1>–ü–ª–∞–Ω –ó–∞—É—á–∏–≤–∞–Ω–∏—è</h1>
        </div>
        <div class="user-panel">
            –ß—Ç–µ—Ü: <strong id="userNameDisp">...</strong>
            <button class="btn-link" onclick="openSettings()">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            <button class="btn-link" style="color:red" onclick="logout()">–í—ã—Ö–æ–¥</button>
        </div>
    </header>

    <div class="instruction-box">
        <h3>üìã –û–ø–∏—Å–∞–Ω–∏–µ –ú–µ—Ç–æ–¥–∏–∫–∏:</h3>
        <p><span class="f-tag f5">–ö—Ä–µ–ø–æ—Å—Ç—å 5 (–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞):</span> –ü—Ä–æ—Å–ª—É—à–∞—Ç—å –∏ –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å –ª–∏—Å—Ç–∞ —Ç–æ, —á—Ç–æ –±—É–¥–µ—Ç–µ —É—á–∏—Ç—å <b>–∑–∞–≤—Ç—Ä–∞</b>. (5-10 –º–∏–Ω).</p>
        <p><span class="f-tag f1">–ö—Ä–µ–ø–æ—Å—Ç—å 1 (–ù–æ–≤–æ–µ / –°–∞–±–∞–∫):</span> –ó–∞—É—á–∏–≤–∞–Ω–∏–µ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏—Ö 5-7 —Å—Ç—Ä–æ–∫. (30-40 –º–∏–Ω). –¶–µ–ª—å: –ø—Ä–æ—á–∏—Ç–∞—Ç—å –ø–æ –ø–∞–º—è—Ç–∏ –±–µ–∑ –æ—à–∏–±–æ–∫ 40 —Ä–∞–∑.</p>
        <p><span class="f-tag f2">–ö—Ä–µ–ø–æ—Å—Ç—å 2 (–°–≤—è–∑–∫–∞ / –°–∞–±–∫–∏):</span> –ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ —Ç–æ–≥–æ, —á—Ç–æ –≤—ã—É—á–∏–ª–∏ –∑–∞ <b>–ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π</b>. –≠—Ç–æ —Å–∞–º–∞—è –≤–∞–∂–Ω–∞—è —á–∞—Å—Ç—å.</p>
        <p><span class="f-tag f3">–ö—Ä–µ–ø–æ—Å—Ç—å 3 (–ë–ª–∏–∑–∫–æ–µ –ø—Ä–æ—à–ª–æ–µ):</span> –ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –≤—Å–µ–≥–æ –≤—ã—É—á–µ–Ω–Ω–æ–≥–æ –¥–æ "–°–≤—è–∑–∫–∏". (–ê—Ä—Ö–∏–≤).</p>
        <p><span class="f-tag" style="background:#666">–ö—Ä–µ–ø–æ—Å—Ç—å 4:</span> (–î–∞–ª–µ–∫–æ–µ –ø—Ä–æ—à–ª–æ–µ - –ø–æ–∫–∞ –Ω–µ –∞–∫—Ç–∏–≤–Ω–æ).</p>
    </div>

    <div class="table-wrap" id="tableWrapper">
        <!-- –¢–∞–±–ª–∏—Ü–∞ -->
    </div>
</div>

<!-- 3. –ù–ê–°–¢–†–û–ô–ö–ò -->
<div class="modal" id="settingsModal">
    <div class="modal-content">
        <h2 style="margin-top:0">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–ª–∞–Ω–∞</h2>
        
        <label>–° –∫–∞–∫–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–∞—á–∞—Ç—å?</label>
        <input type="number" id="inpStartPage" value="1" min="1" max="604">

        <label>–° –∫–∞–∫–æ–π —Å—Ç—Ä–æ–∫–∏ –Ω–∞—á–∞—Ç—å? (1-15)</label>
        <input type="number" id="inpStartLine" value="1" min="1" max="15">

        <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ –¥–µ–Ω—å:</label>
        <select id="inpPace">
            <option value="3">3 —Å—Ç—Ä–æ–∫–∏</option>
            <option value="5">5 —Å—Ç—Ä–æ–∫</option>
            <option value="7">7 —Å—Ç—Ä–æ–∫ (–ü–æ–ª—Å—Ç—Ä–∞–Ω–∏—Ü—ã)</option>
            <option value="15">15 —Å—Ç—Ä–æ–∫ (–°—Ç—Ä–∞–Ω–∏—Ü–∞)</option>
        </select>

        <label>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–ª–∞–Ω–∞ (–¥–Ω–µ–π):</label>
        <select id="inpDuration">
            <option value="14">14 –¥–Ω–µ–π</option>
            <option value="30">30 –¥–Ω–µ–π</option>
            <option value="60">60 –¥–Ω–µ–π</option>
        </select>

        <button class="btn-action" onclick="generatePlan()">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
        <button class="btn-action" style="background:transparent; color:#333; border:1px solid #ccc; margin-top:10px;" onclick="closeSettings()">–û—Ç–º–µ–Ω–∞</button>
    </div>
</div>

<script>
    let currentUser = null;
    let data = {};

    // --- –í–•–û–î ---
    function attemptLogin(user) {
        if (user === 'Ayub') {
            const pass = prompt("–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è Ayub:");
            if (pass !== '1337') { alert("–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å"); return; }
        }
        currentUser = user;
        localStorage.setItem('f5_user', user);
        document.getElementById('userNameDisp').innerText = user;
        document.getElementById('loginOverlay').style.display = 'none';
        document.getElementById('appContainer').style.display = 'block';
        loadData();
    }

    function logout() {
        currentUser = null;
        localStorage.removeItem('f5_user');
        document.getElementById('appContainer').style.display = 'none';
        document.getElementById('loginOverlay').style.display = 'flex';
    }

    // --- –î–ê–ù–ù–´–ï ---
    function loadData() {
        const json = localStorage.getItem(`f5_data_${currentUser}`);
        if (json) {
            data = JSON.parse(json);
            if (!data.schedule || data.schedule.length === 0) openSettings();
            else renderTable();
        } else {
            data = { settings: { startPage:1, startLine:1, pace:7, duration:30 }, schedule: [], progress: {} };
            openSettings();
        }
    }

    function saveData() {
        localStorage.setItem(`f5_data_${currentUser}`, JSON.stringify(data));
    }

    // --- –ì–ï–ù–ï–†–ê–¢–û–† (–ú–ê–¢–ï–ú–ê–¢–ò–ö–ê 5 –ö–†–ï–ü–û–°–¢–ï–ô) ---
    function generatePlan() {
        const sPage = parseInt(document.getElementById('inpStartPage').value);
        const sLine = parseInt(document.getElementById('inpStartLine').value);
        const pace = parseInt(document.getElementById('inpPace').value);
        const duration = parseInt(document.getElementById('inpDuration').value);

        data.settings = { sPage, sLine, pace, duration };
        data.progress = {};
        data.schedule = [];

        // 1. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç "–£—Ä–æ–∫–æ–≤" –Ω–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å
        // –ù–∞–º –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å —É—Ä–æ–∫–∏ –Ω–∞–ø–µ—Ä–µ–¥ (–¥–ª—è –ö—Ä.5) –∏ –Ω–∞–∑–∞–¥ (–¥–ª—è –ö—Ä.2)
        let lessons = []; 
        let currP = sPage;
        let currL = sLine;

        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å –∑–∞–ø–∞—Å–æ–º (+1 –¥–µ–Ω—å –¥–ª—è –ö—Ä.5 –∑–∞–≤—Ç—Ä–∞—à–Ω–µ–≥–æ –¥–Ω—è)
        for(let i=0; i <= duration + 1; i++) {
            let startTxt = `–°—Ç—Ä ${currP} (–∞—è—Ç ${currL})`; // –£–ø—Ä–æ—â–µ–Ω–Ω–æ –Ω–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä–æ–∫–æ–π
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–Ω–µ—Ü —É—Ä–æ–∫–∞
            let endL = currL + pace - 1;
            let endP = currP;
            let lessonTxt = "";

            if (endL > 15) {
                // –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å–ª–µ–¥ —Å—Ç—Ä–∞–Ω–∏—Ü—É
                let rem = endL - 15;
                lessonTxt = `–°—Ç—Ä ${currP} (${currL}-15) + –°—Ç—Ä ${currP+1} (1-${rem})`;
                // –°–ª–µ–¥—É—é—â–∏–π —Å—Ç–∞—Ä—Ç
                currP++;
                currL = rem + 1;
            } else {
                // –í –ø—Ä–µ–¥–µ–ª–∞—Ö —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                if (pace === 15) lessonTxt = `–°—Ç—Ä ${currP} (–ü–æ–ª–Ω–∞—è)`;
                else lessonTxt = `–°—Ç—Ä ${currP} (—Å—Ç—Ä–∫ ${currL}-${endL})`;
                // –°–ª–µ–¥—É—é—â–∏–π —Å—Ç–∞—Ä—Ç
                currL = endL + 1;
            }
            
            if (currL > 15) { currL = 1; currP++; }

            lessons.push({
                id: i,
                text: lessonTxt,
                pageVal: endP // –î–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —Å—Ç—Ä–∞–Ω–∏—Ü
            });
        }

        // 2. –°–±–æ—Ä–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –ø–æ –¥–Ω—è–º
        for (let d = 0; d < duration; d++) {
            let dayNum = d + 1;
            
            // –ö—Ä–µ–ø–æ—Å—Ç—å 1 (–°–µ–≥–æ–¥–Ω—è)
            let f1_txt = lessons[d].text;

            // –ö—Ä–µ–ø–æ—Å—Ç—å 5 (–ó–∞–≤—Ç—Ä–∞)
            let f5_txt = lessons[d+1] ? lessons[d+1].text : "–§–∏–Ω–∏—à";

            // –ö—Ä–µ–ø–æ—Å—Ç—å 2 (–°–≤—è–∑–∫–∞ - –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π)
            let f2_txt = "---";
            if (d > 0) {
                let startIdx = Math.max(0, d - 7);
                let endIdx = d - 1;
                // –ë–µ—Ä–µ–º —Ç–µ–∫—Å—Ç —É—Ä–æ–∫–∞ 7-–¥–Ω–µ–≤–Ω–æ–π –¥–∞–≤–Ω–æ—Å—Ç–∏ –∏ –≤—á–µ—Ä–∞—à–Ω–µ–≥–æ
                // –£–ø—Ä–æ—â–µ–Ω–Ω–æ: "–£—Ä–æ–∫–∏ –¥–Ω–µ–π X - Y" –∏–ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω —Å—Ç—Ä–∞–Ω–∏—Ü
                // –ù–æ –ª—É—á—à–µ –≤—ã–≤–µ—Å—Ç–∏ –¥–∏–∞–ø–∞–∑–æ–Ω:
                let startLesson = lessons[startIdx].text.split(' ')[1]; // –ù–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                let endLesson = lessons[endIdx].text.split(' ')[1];
                f2_txt = `–£—Ä–æ–∫–∏ –¥–Ω–µ–π ${startIdx+1}-${endIdx+1}`;
            }

            // –ö—Ä–µ–ø–æ—Å—Ç—å 3 (–ê—Ä—Ö–∏–≤ - –≤—Å—ë –¥–æ –°–≤—è–∑–∫–∏)
            let f3_txt = "---";
            if (d > 7) {
                // –ê—Ä—Ö–∏–≤ —ç—Ç–æ —É—Ä–æ–∫–∏ –æ—Ç 0 –¥–æ (d - 8)
                let archiveEndIdx = d - 8;
                if (archiveEndIdx >= 0) {
                     f3_txt = `–£—Ä–æ–∫–∏ –¥–Ω–µ–π 1-${archiveEndIdx+1}`;
                     // –ï—Å–ª–∏ –º–Ω–æ–≥–æ, –º–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å: "–°—Ç—Ä ${sPage} - ..."
                }
            }

            data.schedule.push({
                d: dayNum,
                f3: f3_txt,
                f2: f2_txt,
                f1: f1_txt,
                f5: f5_txt
            });
        }

        saveData();
        closeSettings();
        renderTable();
    }

    // --- –û–¢–†–ò–°–û–í–ö–ê ---
    function renderTable() {
        const wrapper = document.getElementById('tableWrapper');
        let html = `
            <table>
                <thead>
                    <tr>
                        <th width="5%">–î</th>
                        <th width="20%">–ö—Ä–µ–ø–æ—Å—Ç—å 3<br><small>(–ê—Ä—Ö–∏–≤)</small></th>
                        <th width="20%">–ö—Ä–µ–ø–æ—Å—Ç—å 2<br><small>(–°–≤—è–∑–∫–∞)</small></th>
                        <th width="25%">–ö—Ä–µ–ø–æ—Å—Ç—å 1<br><small>(–ù–æ–≤–æ–µ)</small></th>
                        <th width="25%">–ö—Ä–µ–ø–æ—Å—Ç—å 5<br><small>(–ù–∞ –∑–∞–≤—Ç—Ä–∞)</small></th>
                        <th width="5%">–û–∫</th>
                    </tr>
                </thead>
                <tbody>
        `;

        data.schedule.forEach(row => {
            const key = `d${row.d}`;
            const isDone = data.progress[key];
            const cls = isDone ? 'done-row' : '';

            html += `
                <tr class="${cls}">
                    <td><strong>${row.d}</strong></td>
                    <td class="col-f3">${row.f3}</td>
                    <td class="col-f2">${row.f2}</td>
                    <td class="col-f1">${row.f1}</td>
                    <td class="col-f5">${row.f5}</td>
                    <td style="text-align:center">
                        <input type="checkbox" ${isDone ? 'checked' : ''} onchange="toggle('${key}')">
                    </td>
                </tr>
            `;
        });
        html += `</tbody></table>`;
        wrapper.innerHTML = html;
    }

    function toggle(key) {
        data.progress[key] = !data.progress[key];
        saveData();
        renderTable();
    }

    function openSettings() { document.getElementById('settingsModal').style.display = 'flex'; }
    function closeSettings() { document.getElementById('settingsModal').style.display = 'none'; }

    // Init
    const lastUser = localStorage.getItem('f5_user');
    if(lastUser) {
        // –û—Å—Ç–∞–≤–ª—è–µ–º —ç–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞, —á—Ç–æ–±—ã —Å–ø—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å —É Ayub, –µ—Å–ª–∏ –Ω–∞–¥–æ, 
        // –∏–ª–∏ –∞–≤—Ç–æ-–ª–æ–≥–∏–Ω –¥–ª—è –¥—Ä—É–≥–∏—Ö. –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã - –≤—Å–µ–≥–¥–∞ —ç–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞.
    }
</script>
</body>
</html>
