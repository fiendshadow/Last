<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>План Хифза: Месяц 1</title>
    <style>
        :root {
            --primary: #10b981; /* Изумрудный зеленый */
            --primary-dark: #059669;
            --bg: #f3f4f6;
            --card-bg: #ffffff;
            --text: #1f2937;
            --text-light: #6b7280;
            --border: #e5e7eb;
            --accent-bg: #d1fae5;
        }

        /* Темная тема (автоматически) */
        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #111827;
                --card-bg: #1f2937;
                --text: #f9fafb;
                --text-light: #9ca3af;
                --border: #374151;
                --accent-bg: #064e3b;
            }
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 0;
            line-height: 1.5;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            padding-bottom: 80px; /* Место для футера */
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        .bismillah {
            font-family: "Traditional Arabic", serif;
            font-size: 24px;
            color: var(--primary);
            margin-bottom: 10px;
            display: block;
        }

        h1 {
            font-size: 22px;
            margin: 0;
            font-weight: 700;
        }

        /* Прогресс бар */
        .progress-container {
            background-color: var(--border);
            border-radius: 99px;
            height: 10px;
            width: 100%;
            margin-top: 15px;
            overflow: hidden;
        }

        .progress-bar {
            background-color: var(--primary);
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
        }

        .stats {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            color: var(--text-light);
            margin-top: 5px;
        }

        /* Карточка дня */
        .day-card {
            background-color: var(--card-bg);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border);
            transition: transform 0.2s, opacity 0.3s;
        }

        .day-card.completed {
            opacity: 0.6;
            border-color: var(--primary);
        }

        .day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border);
        }

        .day-title {
            font-weight: 700;
            font-size: 18px;
            color: var(--primary);
        }

        .day-status {
            font-size: 20px;
        }

        /* Список задач внутри дня */
        .task-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .task-item {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: background 0.2s;
        }

        .task-item:active {
            background-color: var(--border);
        }

        /* Кастомный чекбокс */
        .checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid var(--text-light);
            border-radius: 6px;
            margin-right: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            transition: all 0.2s;
        }

        .task-item.checked .checkbox {
            background-color: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        .task-item.checked .task-text {
            text-decoration: line-through;
            color: var(--text-light);
        }

        .task-label {
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            color: var(--text-light);
            margin-bottom: 2px;
            display: block;
        }
        
        .task-item.checked .task-label {
            color: var(--primary-dark);
        }

        .task-desc {
            font-size: 16px;
            font-weight: 500;
        }

        /* Метки типов задач */
        .tag {
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 4px;
            margin-left: auto;
            font-weight: bold;
        }
        .tag-manzil { background: #fee2e2; color: #991b1b; } /* Красный оттенок */
        .tag-sabki { background: #fef3c7; color: #92400e; } /* Желтый оттенок */
        .tag-sabak { background: #d1fae5; color: #065f46; } /* Зеленый оттенок */

        /* Темная тема для тегов */
        @media (prefers-color-scheme: dark) {
            .tag-manzil { background: #7f1d1d; color: #fecaca; }
            .tag-sabki { background: #78350f; color: #fde68a; }
            .tag-sabak { background: #064e3b; color: #a7f3d0; }
        }

        .footer-note {
            text-align: center;
            font-size: 12px;
            color: var(--text-light);
            margin-top: 30px;
        }

        .btn-reset {
            display: block;
            margin: 20px auto;
            background: none;
            border: 1px solid var(--text-light);
            color: var(--text-light);
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
        }

    </style>
</head>
<body>

<div class="container">
    <header>
        <span class="bismillah">بِسْمِ اللّهِ الرَّحْمَنِ الرَّحِيمِ</span>
        <h1>Мой План Хифза</h1>
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        <div class="stats">
            <span id="progressText">0%</span>
            <span>Дней: <span id="completedDays">0</span>/30</span>
        </div>
    </header>

    <div id="daysContainer">
        <!-- Карточки дней генерируются здесь через JS -->
    </div>

    <div class="footer-note">
        <p>Пусть Аллах облегчит вам путь к знаниям.</p>
        <button class="btn-reset" onclick="resetProgress()">Сбросить прогресс</button>
    </div>
</div>

<script>
    // --- ДАННЫЕ ПРОГРАММЫ ---
    // Формат: day (день), manzil (архив), sabki (связка), sabak (новое)
    const schedule = [
        { d: 1, m: "Стр 3–8", s: "Стр 14–18", n: "Стр 19 (Верх)" },
        { d: 2, m: "Стр 9–13", s: "Стр 14–18 + 19в", n: "Стр 19 (Низ)" },
        { d: 3, m: "Стр 3–8", s: "Стр 15–19", n: "Стр 20 (Верх)" },
        { d: 4, m: "Стр 9–13", s: "Стр 15–19 + 20в", n: "Стр 20 (Низ)" },
        { d: 5, m: "Стр 3–8", s: "Стр 16–20", n: "Стр 21 (Верх)" },
        { d: 6, m: "Стр 9–13", s: "Стр 16–20 + 21в", n: "Стр 21 (Низ)" },
        { d: 7, m: "ОТДЫХ ОТ НОВОГО", s: "Прочитать весь 1-й Джуз (Стр 1–21)", n: "Нет урока" },
        
        { d: 8, m: "Стр 3–10", s: "Стр 19–21 + [17,18]", n: "Стр 22 (Верх)" },
        { d: 9, m: "Стр 11–18", s: "Стр 18–22 (слитно)", n: "Стр 22 (Низ)" },
        { d: 10, m: "Стр 3–10", s: "Стр 19–22", n: "Стр 23 (Верх)" },
        { d: 11, m: "Стр 11–18", s: "Стр 19–22 + 23в", n: "Стр 23 (Низ)" },
        { d: 12, m: "Стр 3–10", s: "Стр 20–23", n: "Стр 24 (Верх)" },
        { d: 13, m: "Стр 11–18", s: "Стр 20–23 + 24в", n: "Стр 24 (Низ)" },
        { d: 14, m: "ПОВТОРЕНИЕ", s: "Стр 22–24 + Связка", n: "Нет урока" },
        
        { d: 15, m: "Стр 3–12", s: "Стр 21–24", n: "Стр 25 (Верх)" },
        { d: 16, m: "Стр 13–21", s: "Стр 21–24 + 25в", n: "Стр 25 (Низ)" },
        { d: 17, m: "Стр 3–12", s: "Стр 22–25", n: "Стр 26 (Верх)" },
        { d: 18, m: "Стр 13–21", s: "Стр 22–25 + 26в", n: "Стр 26 (Низ)" },
        { d: 19, m: "Стр 3–12", s: "Стр 23–26", n: "Стр 27 (Верх)" },
        { d: 20, m: "Стр 13–21", s: "Стр 23–26 + 27в", n: "Стр 27 (Низ)" },
        { d: 21, m: "ПОВТОРЕНИЕ", s: "Повторить неделю", n: "Нет урока" },
        
        { d: 22, m: "Стр 3–14", s: "Стр 24–27", n: "Стр 28 (Верх)" },
        { d: 23, m: "Стр 15–24", s: "Стр 24–27 + 28в", n: "Стр 28 (Низ)" },
        { d: 24, m: "Стр 3–14", s: "Стр 25–28", n: "Стр 29 (Верх)" },
        { d: 25, m: "Стр 15–24", s: "Стр 25–28 + 29в", n: "Стр 29 (Низ)" },
        { d: 26, m: "Стр 3–14", s: "Стр 26–29", n: "Стр 30 (Верх)" },
        { d: 27, m: "Стр 15–24", s: "Стр 26–29 + 30в", n: "Стр 30 (Низ)" },
        
        { d: 28, m: "Стр 3–21 (Весь 1 Дж)", s: "Связка", n: "Стр 31 (Верх)" },
        { d: 29, m: "Стр 22–29", s: "Связка", n: "Стр 31 (Низ)" },
        { d: 30, m: "ЭКЗАМЕН", s: "Прочитать стр 19–31", n: "Финиш" }
    ];

    const STORAGE_KEY = 'hifz_tracker_v1';
    let progress = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {};

    // --- ЛОГИКА ПРИЛОЖЕНИЯ ---

    function init() {
        const container = document.getElementById('daysContainer');
        container.innerHTML = '';
        let firstUnfinished = null;

        schedule.forEach((day, index) => {
            // Создаем ID для каждого чекбокса: day_1_manzil, day_1_sabki...
            const mKey = `d${day.d}_m`;
            const sKey = `d${day.d}_s`;
            const nKey = `d${day.d}_n`;

            const isMDone = progress[mKey];
            const isSDone = progress[sKey];
            const isNDone = progress[nKey];
            const isDayDone = isMDone && isSDone && isNDone;

            if (!firstUnfinished && !isDayDone) {
                firstUnfinished = `day-${day.d}`;
            }

            // HTML Шаблон карточки
            const card = document.createElement('div');
            card.className = `day-card ${isDayDone ? 'completed' : ''}`;
            card.id = `day-${day.d}`;
            card.innerHTML = `
                <div class="day-header">
                    <span class="day-title">День ${day.d}</span>
                    <span class="day-status">${isDayDone ? '✅' : ''}</span>
                </div>
                <ul class="task-list">
                    <li class="task-item ${isMDone ? 'checked' : ''}" onclick="toggle('${mKey}')">
                        <div class="checkbox">${isMDone ? '✓' : ''}</div>
                        <div class="task-info">
                            <span class="task-label">Манзиль (Старое)</span>
                            <span class="task-desc">${day.m}</span>
                        </div>
                        <span class="tag tag-manzil">Архив</span>
                    </li>
                    <li class="task-item ${isSDone ? 'checked' : ''}" onclick="toggle('${sKey}')">
                        <div class="checkbox">${isSDone ? '✓' : ''}</div>
                        <div class="task-info">
                            <span class="task-label">Сабки (Связка)</span>
                            <span class="task-desc">${day.s}</span>
                        </div>
                        <span class="tag tag-sabki">Важно</span>
                    </li>
                    <li class="task-item ${isNDone ? 'checked' : ''}" onclick="toggle('${nKey}')">
                        <div class="checkbox">${isNDone ? '✓' : ''}</div>
                        <div class="task-info">
                            <span class="task-label">Сабак (Новое)</span>
                            <span class="task-desc">${day.n}</span>
                        </div>
                        <span class="tag tag-sabak">Урок</span>
                    </li>
                </ul>
            `;
            container.appendChild(card);
        });

        updateStats();
        
        // Скролл к текущему дню (плавный)
        if (firstUnfinished) {
            setTimeout(() => {
                document.getElementById(firstUnfinished).scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 500);
        }
    }

    function toggle(key) {
        if (progress[key]) {
            delete progress[key];
        } else {
            progress[key] = true;
        }
        localStorage.setItem(STORAGE_KEY, JSON.stringify(progress));
        init(); // Перерисовка
    }

    function updateStats() {
        // Подсчет выполненных дней
        let completedDays = 0;
        let totalTasks = schedule.length * 3;
        let completedTasks = 0;

        schedule.forEach(day => {
            const m = progress[`d${day.d}_m`];
            const s = progress[`d${day.d}_s`];
            const n = progress[`d${day.d}_n`];
            if (m && s && n) completedDays++;
            if (m) completedTasks++;
            if (s) completedTasks++;
            if (n) completedTasks++;
        });

        const percent = Math.round((completedTasks / totalTasks) * 100);
        
        document.getElementById('progressBar').style.width = `${percent}%`;
        document.getElementById('progressText').innerText = `${percent}%`;
        document.getElementById('completedDays').innerText = completedDays;
    }

    function resetProgress() {
        if(confirm('Вы уверены, что хотите сбросить весь прогресс?')) {
            localStorage.removeItem(STORAGE_KEY);
            progress = {};
            init();
        }
    }

    // Запуск при загрузке
    init();

</script>
</body>
</html> 
